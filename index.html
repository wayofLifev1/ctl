<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Command // Super Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        body { background-color: #0f172a; font-family: 'Space Grotesk', sans-serif; color: #e2e8f0; }
        
        /* Glassmorphism Cards */
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .glass-panel:hover {
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
        }

        /* Status Dots */
        .dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; }
        .dot.green { background-color: #10b981; box-shadow: 0 0 10px #10b981; }
        .dot.red { background-color: #ef4444; }
        .dot.yellow { background-color: #f59e0b; }
        
        /* Auth Screen */
        #auth-overlay {
            position: fixed; inset: 0; z-index: 50;
            background: #020617;
            display: flex; justify-content: center; align-items: center;
        }
        .pin-input {
            background: transparent; border-bottom: 2px solid #334155;
            color: white; font-size: 2rem; letter-spacing: 1rem;
            text-align: center; width: 200px; outline: none;
        }
        .pin-input:focus { border-color: #3b82f6; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="auth-overlay">
        <div class="text-center">
            <i class="fas fa-fingerprint text-6xl text-slate-700 mb-6"></i>
            <h2 class="text-xl text-slate-400 mb-8 uppercase tracking-widest">Master Control</h2>
            <input type="password" id="masterPin" class="pin-input" maxlength="4" placeholder="••••" autofocus>
        </div>
    </div>

    <main id="dashboard" class="flex-1 p-6 hidden">
        
        <header class="flex justify-between items-center mb-10">
            <div>
                <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">Command Center</h1>
                <p class="text-slate-500 text-sm">Overview across 4 distinct systems</p>
            </div>
            <div class="flex gap-4">
                <div class="text-right">
                    <div id="clock" class="text-xl font-mono font-bold text-slate-200">00:00</div>
                    <div class="text-xs text-green-400"><span class="dot green mr-2"></span>Systems Nominal</div>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">

            <div class="glass-panel rounded-2xl p-6 relative overflow-hidden group">
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition">
                    <i class="fas fa-cookie-bite text-8xl text-amber-500"></i>
                </div>
                <div class="flex justify-between items-start mb-4">
                    <div class="bg-amber-500/20 text-amber-400 px-3 py-1 rounded-full text-xs font-bold border border-amber-500/30">V5 PRO</div>
                    <button onclick="launch('pipahV5')" class="text-slate-400 hover:text-white"><i class="fas fa-external-link-alt"></i></button>
                </div>
                <h2 class="text-xl font-bold text-white mb-1">Pipah Cookies</h2>
                <p class="text-xs text-slate-500 mb-6">Inventory & Reseller System</p>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Products</span>
                        <span id="p5-products" class="text-2xl font-bold text-white">--</span>
                    </div>
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Trending</span>
                        <span id="p5-trending" class="text-2xl font-bold text-white">--</span>
                    </div>
                </div>
                <button onclick="launch('pipahV5')" class="w-full mt-6 bg-amber-600 hover:bg-amber-700 text-white py-2 rounded-lg font-bold transition text-sm">Open Admin 5.0</button>
            </div>

            <div class="glass-panel rounded-2xl p-6 relative overflow-hidden group">
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition">
                    <i class="fas fa-mosque text-8xl text-emerald-500"></i>
                </div>
                <div class="flex justify-between items-start mb-4">
                    <div class="bg-emerald-500/20 text-emerald-400 px-3 py-1 rounded-full text-xs font-bold border border-emerald-500/30">WSL APP</div>
                    <button onclick="launch('wsl')" class="text-slate-400 hover:text-white"><i class="fas fa-external-link-alt"></i></button>
                </div>
                <h2 class="text-xl font-bold text-white mb-1">Waktu Solat</h2>
                <p class="text-xs text-slate-500 mb-6">Users & Content Management</p>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Total Installs</span>
                        <span id="wsl-users" class="text-2xl font-bold text-white">--</span>
                    </div>
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Active (24h)</span>
                        <span id="wsl-active" class="text-2xl font-bold text-emerald-400">--</span>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-2 mt-6">
                    <button onclick="launch('wsl_analytics')" class="bg-emerald-900/50 hover:bg-emerald-900 border border-emerald-500/30 text-emerald-400 py-2 rounded-lg font-bold transition text-xs">Analytics</button>
                    <button onclick="launch('wsl_content')" class="bg-emerald-600 hover:bg-emerald-700 text-white py-2 rounded-lg font-bold transition text-xs">Content</button>
                </div>
            </div>

            <div class="glass-panel rounded-2xl p-6 relative overflow-hidden group">
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition">
                    <i class="fas fa-gamepad text-8xl text-purple-500"></i>
                </div>
                <div class="flex justify-between items-start mb-4">
                    <div class="bg-purple-500/20 text-purple-400 px-3 py-1 rounded-full text-xs font-bold border border-purple-500/30">GAME</div>
                    <button onclick="launch('arcade')" class="text-slate-400 hover:text-white"><i class="fas fa-external-link-alt"></i></button>
                </div>
                <h2 class="text-xl font-bold text-white mb-1">Galaxy Arcade</h2>
                <p class="text-xs text-slate-500 mb-6">Realtime Game Backend</p>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Live Players</span>
                        <div class="flex items-center gap-2">
                            <span class="dot green animate-pulse"></span>
                            <span id="arc-online" class="text-2xl font-bold text-green-400">--</span>
                        </div>
                    </div>
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Total Launches</span>
                        <span id="arc-visits" class="text-2xl font-bold text-white">--</span>
                    </div>
                </div>
                <button onclick="launch('arcade')" class="w-full mt-6 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-bold transition text-sm">Open Galaxy Command</button>
            </div>

            <div class="glass-panel rounded-2xl p-6 relative overflow-hidden group grayscale opacity-75 hover:grayscale-0 hover:opacity-100 transition duration-500">
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition">
                    <i class="fas fa-warehouse text-8xl text-blue-500"></i>
                </div>
                <div class="flex justify-between items-start mb-4">
                    <div class="bg-slate-700 text-slate-300 px-3 py-1 rounded-full text-xs font-bold border border-slate-600">LEGACY</div>
                    <button onclick="launch('pipahHQ')" class="text-slate-400 hover:text-white"><i class="fas fa-external-link-alt"></i></button>
                </div>
                <h2 class="text-xl font-bold text-white mb-1">HQ Admin</h2>
                <p class="text-xs text-slate-500 mb-6">Old Order System (d6b3b)</p>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Total Orders</span>
                        <span id="hq-orders" class="text-2xl font-bold text-white">--</span>
                    </div>
                    <div class="flex justify-between items-end border-b border-slate-700 pb-2">
                        <span class="text-slate-400 text-sm">Revenue</span>
                        <span id="hq-revenue" class="text-2xl font-bold text-blue-400">--</span>
                    </div>
                </div>
                <button onclick="launch('pipahHQ')" class="w-full mt-6 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded-lg font-bold transition text-sm">Open Legacy Panel</button>
            </div>

        </div>
    </main>

    <script>
        // ============================================
        // 1. CONFIGURE YOUR URLS HERE
        // ============================================
        const ADMIN_URLS = {
            pipahV5: "https://pipahcookiesapp.github.io/com/admin.html", 
            wsl_analytics: "https://twolife-v1.github.io/my/admin.html",
            wsl_content: "https://twolife-v1.github.io/my/updater.html",
            arcade: "https://wayoflifev1.github.io/play/admin.html",
            pipahHQ: "https://rspipahcookies.github.io/my/HQ_Admin.html"
        };

        function launch(key) {
            const url = ADMIN_URLS[key];
            if(url && url.includes('your-')) {
                alert("Please configure the URLs in the SuperAdmin.html file first!");
            } else {
                window.open(url, '_blank');
            }
        }

        // ============================================
        // 2. FIREBASE CONFIGS (Extracted from your files)
        // ============================================
        
        // A. Pipah Admin 5.0 (Firestore)
        const cfgPipahV5 = { apiKey: "AIzaSyA2Y2cOh3J7U916Ip0tnDDFVs2fK6sACl0", projectId: "pipahcookies-21e38", appId: "1:162482379926:web:14d16f5a2444816876f6b7" };

        // B. Waktu Solat Lite (Realtime DB)
        const cfgWSL = { apiKey: "AIzaSyBQMVNRDYsKHRj_-bwKbFICyN6XseL3CDI", databaseURL: "https://waktusolatlite-default-rtdb.asia-southeast1.firebasedatabase.app", projectId: "waktusolatlite" };

        // C. Arcade Galaxy (Realtime DB)
        const cfgArcade = { apiKey: "AIzaSyCYPD6eFQvtwi6CMBkAbQ1SmkWA2qtby9s", databaseURL: "https://wofplay-123-default-rtdb.firebaseio.com", projectId: "wofplay-123" };

        // D. Pipah HQ / Legacy (Firestore)
        const cfgPipahHQ = { apiKey: "AIzaSyABXTYtbuFrlYo3AubzNQKOE2hRWSkompU", projectId: "pipahcookies-d6b3b" };

        // ============================================
        // 3. INITIALIZATION & LOGIC
        // ============================================

        // Initialize Multiple Apps
        let appV5, appWSL, appArcade, appHQ;

        function initSystems() {
            try {
                // Initialize distinct apps by name to avoid conflict
                appV5 = firebase.initializeApp(cfgPipahV5, "PipahV5");
                appWSL = firebase.initializeApp(cfgWSL, "WSL");
                appArcade = firebase.initializeApp(cfgArcade, "Arcade");
                appHQ = firebase.initializeApp(cfgPipahHQ, "PipahHQ");

                startListeners();
            } catch(e) {
                console.error("Firebase Init Error:", e);
                alert("Error initializing systems. Check console.");
            }
        }

        function startListeners() {
            // --- 1. PIPAH V5 LISTENERS (Firestore) ---
            const dbV5 = appV5.firestore();
            dbV5.collection('products').onSnapshot(snap => {
                document.getElementById('p5-products').innerText = snap.size;
            });
            dbV5.collection('trending_products').onSnapshot(snap => {
                document.getElementById('p5-trending').innerText = snap.size;
            });

            // --- 2. WSL LISTENERS (Realtime DB) ---
            const rtdbWSL = appWSL.database();
            rtdbWSL.ref('users').on('value', snap => {
                const users = snap.val() || {};
                const total = Object.keys(users).length;
                
                // Calc Active (Last 24h)
                const oneDayAgo = Date.now() - (86400 * 1000);
                let active = 0;
                Object.values(users).forEach(u => {
                    if(u.lastActive && u.lastActive > oneDayAgo) active++;
                });

                document.getElementById('wsl-users').innerText = total;
                document.getElementById('wsl-active').innerText = active;
            });

            // --- 3. ARCADE LISTENERS (Realtime DB) ---
            const rtdbArcade = appArcade.database();
            rtdbArcade.ref('stats/visits').on('value', snap => {
                document.getElementById('arc-visits').innerText = snap.val() || 0;
            });
            rtdbArcade.ref('status').on('value', snap => {
                const s = snap.val() || {};
                let online = 0;
                Object.values(s).forEach(x => { if(x.state === 'online') online++; });
                document.getElementById('arc-online').innerText = online;
            });

            // --- 4. HQ LEGACY LISTENERS (Firestore) ---
            const dbHQ = appHQ.firestore();
            dbHQ.collection('orders').onSnapshot(snap => {
                let count = 0;
                let rev = 0;
                snap.forEach(doc => {
                    count++;
                    rev += (doc.data().total || 0);
                });
                document.getElementById('hq-orders').innerText = count;
                document.getElementById('hq-revenue').innerText = "RM " + rev.toFixed(0);
            });
        }

        // ============================================
        // 4. UI LOGIC
        // ============================================
        
        // Clock
        setInterval(() => {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('en-US', {hour12:false, hour:'2-digit', minute:'2-digit'});
        }, 1000);

        // Login
        const pinInput = document.getElementById('masterPin');
        pinInput.addEventListener('keyup', (e) => {
            if(pinInput.value === '1234') { // <--- MASTER PIN
                document.getElementById('auth-overlay').style.display = 'none';
                document.getElementById('dashboard').classList.remove('hidden');
                initSystems();
            }
        });

    </script>
</body>
</html>
